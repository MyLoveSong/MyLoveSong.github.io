<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³ä¹ç››å®´ç½‘ç«™ - è°ƒè¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .debug-section {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        .success { color: #4ade80; }
        .error { color: #f87171; }
        .warning { color: #fbbf24; }
        .info { color: #60a5fa; }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #2563eb;
        }
        pre {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>ğŸµ éŸ³ä¹ç››å®´ç½‘ç«™ - è°ƒè¯•é¡µé¢</h1>
    
    <div class="debug-section">
        <h2>ğŸ” æ¨¡å—åŠ è½½çŠ¶æ€æ£€æŸ¥</h2>
        <button onclick="checkModules()">æ£€æŸ¥æ¨¡å—çŠ¶æ€</button>
        <button onclick="testGitHubAPI()">æµ‹è¯•GitHub API</button>
        <button onclick="testThemeToggle()">æµ‹è¯•ä¸»é¢˜åˆ‡æ¢</button>
        <button onclick="clearConsole()">æ¸…ç©ºæ§åˆ¶å°</button>
        <div id="module-status"></div>
    </div>
    
    <div class="debug-section">
        <h2>ğŸ“Š æ§åˆ¶å°è¾“å‡º</h2>
        <div id="console-output" style="height: 300px; overflow-y: auto; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 5px; font-family: monospace;"></div>
    </div>
    
    <div class="debug-section">
        <h2>ğŸ”§ æ‰‹åŠ¨åˆå§‹åŒ–</h2>
        <button onclick="manualInit()">æ‰‹åŠ¨åˆå§‹åŒ–æ‰€æœ‰æ¨¡å—</button>
        <button onclick="forceLoad()">å¼ºåˆ¶åŠ è½½è„šæœ¬</button>
        <div id="init-status"></div>
    </div>

    <script>
        // é‡å†™console.logæ¥æ•è·è¾“å‡º
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;
        
        function addToConsole(type, message) {
            const output = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            const div = document.createElement('div');
            div.style.color = type === 'error' ? '#f87171' : type === 'warn' ? '#fbbf24' : '#60a5fa';
            div.innerHTML = `[${timestamp}] ${type.toUpperCase()}: ${message}`;
            output.appendChild(div);
            output.scrollTop = output.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsole('log', args.join(' '));
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToConsole('warn', args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsole('error', args.join(' '));
        };
        
        // æ£€æŸ¥æ¨¡å—çŠ¶æ€
        function checkModules() {
            const status = document.getElementById('module-status');
            const modules = [
                'ProjectManager',
                'SkillVisualizer', 
                'TimelineManager',
                'OptimizedBlogSystem',
                'MapManager',
                'ThemeManager',
                'UIEffectsManager',
                'MusicWebsiteCore'
            ];
            
            let html = '<h3>æ¨¡å—çŠ¶æ€:</h3>';
            modules.forEach(moduleName => {
                const isDefined = typeof window[moduleName] !== 'undefined';
                const color = isDefined ? 'success' : 'error';
                const icon = isDefined ? 'âœ…' : 'âŒ';
                html += `<p class="${color}">${icon} ${moduleName}: ${isDefined ? 'å·²åŠ è½½' : 'æœªåŠ è½½'}</p>`;
            });
            
            // æ£€æŸ¥å…¨å±€å˜é‡
            html += '<h3>å…¨å±€å˜é‡çŠ¶æ€:</h3>';
            const globals = [
                'projectManager',
                'skillVisualizer',
                'timelineManager', 
                'blogSystem',
                'mapManager',
                'themeManager',
                'uiEffectsManager',
                'musicWebsiteCore'
            ];
            
            globals.forEach(globalName => {
                const isDefined = typeof window[globalName] !== 'undefined';
                const color = isDefined ? 'success' : 'warning';
                const icon = isDefined ? 'âœ…' : 'âš ï¸';
                html += `<p class="${color}">${icon} ${globalName}: ${isDefined ? 'å·²å®šä¹‰' : 'æœªå®šä¹‰'}</p>`;
            });
            
            status.innerHTML = html;
        }
        
        // æµ‹è¯•GitHub API
        function testGitHubAPI() {
            console.log('ğŸ§ª æµ‹è¯•GitHub API...');
            if (typeof window.projectManager !== 'undefined') {
                console.log('âœ… projectManager å·²åŠ è½½');
                if (window.projectManager.fetchProjects) {
                    console.log('âœ… fetchProjects æ–¹æ³•å¯ç”¨');
                    window.projectManager.fetchProjects().then(() => {
                        console.log('âœ… GitHub API æµ‹è¯•æˆåŠŸ');
                    }).catch(error => {
                        console.error('âŒ GitHub API æµ‹è¯•å¤±è´¥:', error);
                    });
                } else {
                    console.warn('âš ï¸ fetchProjects æ–¹æ³•ä¸å¯ç”¨');
                }
            } else {
                console.error('âŒ projectManager æœªåŠ è½½');
            }
        }
        
        // æµ‹è¯•ä¸»é¢˜åˆ‡æ¢
        function testThemeToggle() {
            console.log('ğŸ§ª æµ‹è¯•ä¸»é¢˜åˆ‡æ¢...');
            if (typeof window.themeManager !== 'undefined') {
                console.log('âœ… themeManager å·²åŠ è½½');
                if (window.themeManager.toggleTheme) {
                    console.log('âœ… toggleTheme æ–¹æ³•å¯ç”¨');
                    window.themeManager.toggleTheme();
                    console.log('âœ… ä¸»é¢˜åˆ‡æ¢æµ‹è¯•æˆåŠŸ');
                } else {
                    console.warn('âš ï¸ toggleTheme æ–¹æ³•ä¸å¯ç”¨');
                }
            } else {
                console.error('âŒ themeManager æœªåŠ è½½');
            }
        }
        
        // æ¸…ç©ºæ§åˆ¶å°
        function clearConsole() {
            document.getElementById('console-output').innerHTML = '';
        }
        
        // æ‰‹åŠ¨åˆå§‹åŒ–
        function manualInit() {
            console.log('ğŸ”„ æ‰‹åŠ¨åˆå§‹åŒ–æ‰€æœ‰æ¨¡å—...');
            const status = document.getElementById('init-status');
            
            try {
                // å°è¯•åŠ è½½æ‰€æœ‰æ¨¡å—
                const modules = [
                    'js/project-manager.js',
                    'js/skill-visualizer.js',
                    'js/timeline-manager.js',
                    'js/blog-system.js',
                    'js/map-manager.js',
                    'js/theme-manager.js',
                    'js/ui-effects.js',
                    'js/music-website-core.js'
                ];
                
                let loadedCount = 0;
                modules.forEach(src => {
                    const script = document.createElement('script');
                    script.src = src;
                    script.onload = () => {
                        loadedCount++;
                        console.log(`âœ… åŠ è½½æˆåŠŸ: ${src}`);
                        if (loadedCount === modules.length) {
                            console.log('ğŸ‰ æ‰€æœ‰æ¨¡å—åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–...');
                            // å»¶è¿ŸåŠ è½½ä¸»è„šæœ¬
                            setTimeout(() => {
                                const mainScript = document.createElement('script');
                                mainScript.src = 'script-new.js';
                                mainScript.onload = () => {
                                    console.log('âœ… ä¸»è„šæœ¬åŠ è½½å®Œæˆ');
                                    status.innerHTML = '<p class="success">âœ… æ‰€æœ‰æ¨¡å—åˆå§‹åŒ–å®Œæˆï¼</p>';
                                };
                                mainScript.onerror = (error) => {
                                    console.error('âŒ ä¸»è„šæœ¬åŠ è½½å¤±è´¥:', error);
                                    status.innerHTML = '<p class="error">âŒ ä¸»è„šæœ¬åŠ è½½å¤±è´¥</p>';
                                };
                                document.head.appendChild(mainScript);
                            }, 1000);
                        }
                    };
                    script.onerror = (error) => {
                        console.error(`âŒ åŠ è½½å¤±è´¥: ${src}`, error);
                    };
                    document.head.appendChild(script);
                });
                
            } catch (error) {
                console.error('âŒ æ‰‹åŠ¨åˆå§‹åŒ–å¤±è´¥:', error);
                status.innerHTML = '<p class="error">âŒ æ‰‹åŠ¨åˆå§‹åŒ–å¤±è´¥</p>';
            }
        }
        
        // å¼ºåˆ¶åŠ è½½è„šæœ¬
        function forceLoad() {
            console.log('ğŸš€ å¼ºåˆ¶åŠ è½½è„šæœ¬...');
            const status = document.getElementById('init-status');
            
            // æ£€æŸ¥æ˜¯å¦å·²ç»æœ‰è„šæœ¬æ ‡ç­¾
            const existingScripts = document.querySelectorAll('script[src*="js/"]');
            if (existingScripts.length > 0) {
                console.log(`ğŸ“ å‘ç° ${existingScripts.length} ä¸ªå·²åŠ è½½çš„è„šæœ¬`);
                status.innerHTML = '<p class="info">ğŸ“ è„šæœ¬å·²åŠ è½½ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°è¾“å‡º</p>';
                return;
            }
            
            // å¼ºåˆ¶é‡æ–°åŠ è½½
            manualInit();
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„æ£€æŸ¥
        window.addEventListener('load', () => {
            console.log('ğŸµ è°ƒè¯•é¡µé¢åŠ è½½å®Œæˆ');
            console.log('ğŸ“ å½“å‰ç¯å¢ƒ:', window.location.protocol);
            console.log('ğŸŒ å»ºè®®ï¼šä½¿ç”¨"æ£€æŸ¥æ¨¡å—çŠ¶æ€"æŒ‰é’®æ¥è¯Šæ–­é—®é¢˜');
            
            // è‡ªåŠ¨æ£€æŸ¥æ¨¡å—çŠ¶æ€
            setTimeout(checkModules, 1000);
        });
        
        // æ•è·å…¨å±€é”™è¯¯
        window.addEventListener('error', (event) => {
            console.error('âŒ å…¨å±€é”™è¯¯:', event.error);
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            console.error('âŒ æœªå¤„ç†çš„Promiseæ‹’ç»:', event.reason);
        });
    </script>
</body>
</html>
