<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³ä¹ç››å®´ç½‘ç«™ - åšå®¢ä¿®å¤æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .test-section {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        .success { color: #4ade80; }
        .error { color: #f87171; }
        .warning { color: #fbbf24; }
        .info { color: #60a5fa; }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #2563eb;
        }
        #console-output {
            height: 300px;
            overflow-y: auto;
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
        }
        .page-info {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸµ éŸ³ä¹ç››å®´ç½‘ç«™ - åšå®¢ä¿®å¤æµ‹è¯•é¡µé¢</h1>
    
    <div class="test-section">
        <h2>âœ… é—®é¢˜ä¿®å¤è¯´æ˜</h2>
        <p><strong>é—®é¢˜æè¿°ï¼š</strong>æ¯ä¸ªç½‘é¡µéƒ½æ˜¾ç¤ºåšå®¢å†…å®¹ï¼ŒåŒ…æ‹¬ä¸»é¡µã€å…³äºé¡µé¢ç­‰</p>
        <p><strong>ä¿®å¤æ–¹æ¡ˆï¼š</strong>åšå®¢ç³»ç»Ÿç°åœ¨åªåœ¨åšå®¢é¡µé¢åˆå§‹åŒ–ï¼Œå…¶ä»–é¡µé¢ä¸ä¼šæ˜¾ç¤ºåšå®¢ç•Œé¢</p>
    </div>
    
    <div class="test-section">
        <h2>ğŸ“„ å½“å‰é¡µé¢ä¿¡æ¯</h2>
        <div class="page-info">
            <p><strong>é¡µé¢æ ‡é¢˜ï¼š</strong> <span id="page-title"></span></p>
            <p><strong>é¡µé¢è·¯å¾„ï¼š</strong> <span id="page-path"></span></p>
            <p><strong>æ˜¯å¦åšå®¢é¡µé¢ï¼š</strong> <span id="is-blog-page"></span></p>
            <p><strong>åšå®¢ç³»ç»ŸçŠ¶æ€ï¼š</strong> <span id="blog-system-status"></span></p>
        </div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ§ª åŠŸèƒ½æµ‹è¯•</h2>
        <button onclick="testBlogSystem()">æµ‹è¯•åšå®¢ç³»ç»Ÿ</button>
        <button onclick="checkPageType()">æ£€æŸ¥é¡µé¢ç±»å‹</button>
        <button onclick="clearConsole()">æ¸…ç©ºæ§åˆ¶å°</button>
    </div>
    
    <div class="test-section">
        <h2>ğŸ“Š æ§åˆ¶å°è¾“å‡º</h2>
        <div id="console-output"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ”§ æŠ€æœ¯è¯´æ˜</h2>
        <p>ä¿®å¤å†…å®¹ï¼š</p>
        <ul>
            <li>æ·»åŠ äº† <code>isBlogPage()</code> æ–¹æ³•æ¥æ£€æµ‹å½“å‰é¡µé¢ç±»å‹</li>
            <li>åšå®¢ç³»ç»Ÿåªåœ¨åšå®¢é¡µé¢åˆå§‹åŒ–ï¼Œé¿å…åœ¨å…¶ä»–é¡µé¢æ˜¾ç¤º</li>
            <li>é€šè¿‡URLè·¯å¾„ã€é¡µé¢æ ‡é¢˜ã€metaæ ‡ç­¾ç­‰æ–¹å¼è¯†åˆ«åšå®¢é¡µé¢</li>
            <li>ä¸»é¡µã€å…³äºé¡µé¢ã€è”ç³»é¡µé¢ç­‰ä¸ä¼šæ˜¾ç¤ºåšå®¢å†…å®¹</li>
        </ul>
    </div>

    <script>
        // é‡å†™console.logæ¥æ•è·è¾“å‡º
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;
        
        function addToConsole(type, message) {
            const output = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            const div = document.createElement('div');
            div.style.color = type === 'error' ? '#f87171' : type === 'warn' ? '#fbbf24' : '#60a5fa';
            div.innerHTML = `[${timestamp}] ${type.toUpperCase()}: ${message}`;
            output.appendChild(div);
            output.scrollTop = output.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsole('log', args.join(' '));
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToConsole('warn', args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsole('error', args.join(' '));
        };
        
        // æ£€æµ‹å½“å‰é¡µé¢æ˜¯å¦æ˜¯åšå®¢é¡µé¢
        function isBlogPage() {
            // æ£€æŸ¥URLè·¯å¾„
            const path = window.location.pathname;
            const isBlogPath = path.includes('blog') || path.includes('posts') || path.endsWith('.html') && path.includes('blog');
            
            // æ£€æŸ¥é¡µé¢æ ‡é¢˜
            const title = document.title.toLowerCase();
            const isBlogTitle = title.includes('åšå®¢') || title.includes('blog');
            
            // æ£€æŸ¥é¡µé¢å†…å®¹
            const hasBlogContent = document.querySelector('.blog-section, .blog-content, #blog, .blog, [data-section="blog"]');
            
            // æ£€æŸ¥æ˜¯å¦æœ‰åšå®¢ç›¸å…³çš„metaæ ‡ç­¾
            const hasBlogMeta = document.querySelector('meta[name="page-type"][content="blog"]') || 
                               document.querySelector('meta[property="og:type"][content="article"]');
            
            // å¦‚æœæ˜¯åšå®¢é¡µé¢ï¼Œè¿”å›true
            if (isBlogPath || isBlogTitle || hasBlogContent || hasBlogMeta) {
                return true;
            }
            
            // æ£€æŸ¥å½“å‰é¡µé¢æ˜¯å¦æ˜¯ä¸»é¡µï¼ˆindex.htmlï¼‰
            if (path.endsWith('index.html') || path.endsWith('/') || path.endsWith('\\')) {
                return false; // ä¸»é¡µä¸æ˜¾ç¤ºåšå®¢ç•Œé¢
            }
            
            // æ£€æŸ¥æ˜¯å¦æ˜¯å…¶ä»–ç‰¹å®šé¡µé¢
            const otherPages = ['about', 'contact', 'products', 'services', 'privacy', 'terms'];
            const isOtherPage = otherPages.some(page => path.includes(page));
            
            if (isOtherPage) {
                return false; // å…¶ä»–é¡µé¢ä¸æ˜¾ç¤ºåšå®¢ç•Œé¢
            }
            
            // é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸æ˜¯æ˜ç¡®æ ‡è¯†çš„åšå®¢é¡µé¢ï¼Œåˆ™ä¸æ˜¾ç¤ºåšå®¢ç•Œé¢
            return false;
        }
        
        // æµ‹è¯•åšå®¢ç³»ç»Ÿ
        function testBlogSystem() {
            console.log('ğŸ§ª æµ‹è¯•åšå®¢ç³»ç»Ÿ...');
            
            if (typeof window.OptimizedBlogSystem !== 'undefined') {
                console.log('âœ… OptimizedBlogSystem ç±»å¯ç”¨');
                
                try {
                    // å°è¯•åˆ›å»ºåšå®¢ç³»ç»Ÿå®ä¾‹
                    const blogSystem = new window.OptimizedBlogSystem();
                    console.log('âœ… åšå®¢ç³»ç»Ÿå®ä¾‹åˆ›å»ºæˆåŠŸ');
                    console.log('åšå®¢ç³»ç»Ÿå®ä¾‹:', blogSystem);
                    
                    // æ£€æŸ¥å®ä¾‹æ–¹æ³•
                    if (blogSystem.loadPosts) {
                        console.log('âœ… loadPosts æ–¹æ³•å¯ç”¨');
                    }
                    if (blogSystem.renderBlogInterface) {
                        console.log('âœ… renderBlogInterface æ–¹æ³•å¯ç”¨');
                    }
                    
                    // æ£€æŸ¥æ˜¯å¦æ¸²æŸ“äº†åšå®¢ç•Œé¢
                    const blogContainer = document.getElementById('blog-container');
                    if (blogContainer) {
                        console.log('âœ… åšå®¢å®¹å™¨å·²å­˜åœ¨');
                        console.log('åšå®¢å®¹å™¨å†…å®¹:', blogContainer.innerHTML.substring(0, 100) + '...');
                    } else {
                        console.log('ğŸ“ åšå®¢å®¹å™¨ä¸å­˜åœ¨ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºå½“å‰é¡µé¢ä¸æ˜¯åšå®¢é¡µé¢ï¼‰');
                    }
                    
                } catch (error) {
                    console.error('âŒ åšå®¢ç³»ç»Ÿå®ä¾‹åˆ›å»ºå¤±è´¥:', error);
                }
                
            } else {
                console.error('âŒ OptimizedBlogSystem ç±»ä¸å¯ç”¨');
            }
        }
        
        // æ£€æŸ¥é¡µé¢ç±»å‹
        function checkPageType() {
            console.log('ğŸ” æ£€æŸ¥é¡µé¢ç±»å‹...');
            
            const path = window.location.pathname;
            const title = document.title;
            const isBlog = isBlogPage();
            
            console.log('é¡µé¢è·¯å¾„:', path);
            console.log('é¡µé¢æ ‡é¢˜:', title);
            console.log('æ˜¯å¦åšå®¢é¡µé¢:', isBlog);
            
            // æ£€æŸ¥metaæ ‡ç­¾
            const blogMeta = document.querySelector('meta[name="page-type"][content="blog"]');
            console.log('åšå®¢metaæ ‡ç­¾:', blogMeta ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
            
            // æ£€æŸ¥é¡µé¢å†…å®¹
            const blogContent = document.querySelector('.blog-section, .blog-content, #blog, .blog, [data-section="blog"]');
            console.log('åšå®¢å†…å®¹å…ƒç´ :', blogContent ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
            
            // æ£€æŸ¥åšå®¢å®¹å™¨
            const blogContainer = document.getElementById('blog-container');
            console.log('åšå®¢å®¹å™¨:', blogContainer ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
            
            if (blogContainer) {
                console.log('åšå®¢å®¹å™¨å†…å®¹é•¿åº¦:', blogContainer.innerHTML.length);
            }
        }
        
        // æ¸…ç©ºæ§åˆ¶å°
        function clearConsole() {
            document.getElementById('console-output').innerHTML = '';
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„æ£€æŸ¥
        window.addEventListener('load', () => {
            console.log('ğŸµ åšå®¢ä¿®å¤æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            console.log('ğŸ“ å½“å‰ç¯å¢ƒ:', window.location.protocol);
            
            // æ›´æ–°é¡µé¢ä¿¡æ¯
            document.getElementById('page-title').textContent = document.title;
            document.getElementById('page-path').textContent = window.location.pathname;
            document.getElementById('is-blog-page').textContent = isBlogPage() ? 'æ˜¯' : 'å¦';
            document.getElementById('blog-system-status').textContent = typeof window.OptimizedBlogSystem !== 'undefined' ? 'å·²åŠ è½½' : 'æœªåŠ è½½';
            
            console.log('ğŸŒ å»ºè®®ï¼šä½¿ç”¨æµ‹è¯•æŒ‰é’®æ¥éªŒè¯ä¿®å¤æ•ˆæœ');
            
            // è‡ªåŠ¨æ£€æŸ¥é¡µé¢ç±»å‹
            setTimeout(checkPageType, 1000);
        });
        
        // æ•è·å…¨å±€é”™è¯¯
        window.addEventListener('error', (event) => {
            console.error('âŒ å…¨å±€é”™è¯¯:', event.error);
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            console.error('âŒ æœªå¤„ç†çš„Promiseæ‹’ç»:', event.reason);
        });
    </script>
</body>
</html>
