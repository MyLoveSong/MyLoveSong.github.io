# 🆓 免费图片API使用说明

## 📋 概述

为了确保每个城市都有图片支持，我们集成了多个免费的图片API服务。这些API提供高质量的城市照片，无需付费即可使用。

## 🎯 支持的免费API

### 1. 📸 Unsplash API
- **特点**: 高质量摄影作品，城市风景照片丰富
- **每日限制**: 1000次请求
- **图片质量**: 极高，专业摄影师作品
- **适用场景**: 城市地标、建筑、风景

**获取API密钥**:
1. 访问 [Unsplash Developers](https://unsplash.com/developers)
2. 注册开发者账户
3. 创建新应用
4. 获取 `Access Key` 和 `Secret Key`

### 2. 🖼️ Pixabay API
- **特点**: 免费图片库，城市照片种类多样
- **每日限制**: 5000次请求
- **图片质量**: 高，用户上传内容
- **适用场景**: 城市生活、文化、建筑

**获取API密钥**:
1. 访问 [Pixabay API](https://pixabay.com/api/docs/)
2. 注册账户
3. 获取API密钥

### 3. 🎭 Pexels API
- **特点**: 精选免费图片，城市主题丰富
- **每日限制**: 200次请求
- **图片质量**: 高，专业筛选
- **适用场景**: 城市景观、旅游景点

**获取API密钥**:
1. 访问 [Pexels API](https://www.pexels.com/api/)
2. 注册账户
3. 获取API密钥

## 🚀 使用方法

### 步骤1: 设置API密钥
1. 在地图控制面板中找到 "🆓 免费图片API" 部分
2. 选择要使用的API服务
3. 输入相应的API密钥
4. 点击 "🔑 设置" 按钮

### 步骤2: 生成城市图片
1. 点击地图上的城市标记
2. 在弹窗中选择图片生成方式:
   - 🎨 AI生成 (需要OpenAI API密钥)
   - 📸 Unsplash (使用Unsplash API)
   - 🖼️ Pixabay (使用Pixabay API)
   - 🎭 Pexels (使用Pexels API)

### 步骤3: 批量生成
- 设置好API密钥后，可以使用 "🎨 生成所有城市图片" 功能
- 系统会自动为所有没有图片的城市生成图片

## ⚠️ 注意事项

### API限制
- **Unsplash**: 每日1000次请求，适合中小规模使用
- **Pixabay**: 每日5000次请求，适合大规模使用
- **Pexels**: 每日200次请求，适合小规模使用

### 图片质量
- 免费API提供的图片质量通常很高
- 图片内容基于关键词搜索，可能与城市不完全匹配
- 建议结合多个API使用，获得最佳效果

### 缓存机制
- 生成的图片会自动缓存，避免重复请求
- 缓存数据存储在浏览器本地存储中
- 清除浏览器数据会丢失缓存

## 🔧 技术特性

### 智能搜索
- 自动构建搜索关键词 (城市名 + "city")
- 支持多种图片方向 (横向、纵向)
- 优先返回高质量图片

### 错误处理
- 网络错误自动重试
- API限制提示
- 优雅降级处理

### 性能优化
- 图片懒加载
- 批量处理避免API限制
- 本地缓存减少重复请求

## 💡 使用建议

### 推荐配置
1. **主要使用**: Pixabay (5000次/天，质量好)
2. **备用选择**: Unsplash (1000次/天，质量极高)
3. **补充选择**: Pexels (200次/天，精选内容)

### 最佳实践
- 先设置一个主要API，再添加备用API
- 定期检查API使用量，避免超出限制
- 结合AI生成和免费API，获得最佳效果

### 故障排除
- 如果某个API无法使用，检查密钥是否正确
- 如果请求失败，可能是达到了每日限制
- 清除浏览器缓存可以解决一些显示问题

## 🌟 优势总结

✅ **完全免费**: 无需支付任何费用  
✅ **高质量**: 专业摄影师作品  
✅ **多样化**: 多种风格和角度  
✅ **易集成**: 简单的API调用  
✅ **智能缓存**: 避免重复请求  
✅ **多选择**: 多个API备选方案  

通过这些免费API，您可以为地图中的每个城市提供丰富的图片支持，大大提升用户体验！
